<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-3.0.43 plugin-docs plugin-id-default docs-doc-id-installation-guide/Backups">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Backups | esthesis CORE</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://esthes.is/docs/3.0.43/installation-guide/Backups"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="3.0.43"><meta data-rh="true" name="docusaurus_tag" content="docs-default-3.0.43"><meta data-rh="true" name="docsearch:version" content="3.0.43"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-3.0.43"><meta data-rh="true" property="og:title" content="Backups | esthesis CORE"><meta data-rh="true" name="description" content="The following sections provide instructions on how to configure backups for the esthesis CORE"><meta data-rh="true" property="og:description" content="The following sections provide instructions on how to configure backups for the esthesis CORE"><link data-rh="true" rel="icon" href="/docs/img/logo.png"><link data-rh="true" rel="canonical" href="https://esthes.is/docs/3.0.43/installation-guide/Backups"><link data-rh="true" rel="alternate" href="https://esthes.is/docs/3.0.43/installation-guide/Backups" hreflang="en"><link data-rh="true" rel="alternate" href="https://esthes.is/docs/3.0.43/installation-guide/Backups" hreflang="x-default"><link rel="stylesheet" href="/docs/assets/css/styles.a79c53ac.css">
<link rel="preload" href="/docs/assets/js/runtime~main.a6375d9b.js" as="script">
<link rel="preload" href="/docs/assets/js/main.6fd6813d.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.png" alt="esthesis" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/logo.png" alt="esthesis" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">esthesis CORE</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/3.0.43/index">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/3.0.43/installation-guide/">Installation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/3.0.43/developers-guide/">Developers</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/3.0.43/contact-support/">Contact</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/3.0.43/index">3.0.43</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/installation-guide/Backups">Next</a></li><li><a class="dropdown__link" href="/docs/installation-guide/Backups">3.0.46</a></li><li><a class="dropdown__link" href="/docs/3.0.45/installation-guide/Backups">3.0.45</a></li><li><a class="dropdown__link" href="/docs/3.0.44/installation-guide/Backups">3.0.44</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/3.0.43/installation-guide/Backups">3.0.43</a></li><li><a class="dropdown__link" href="/docs/3.0.42/installation-guide/Backups">3.0.42</a></li><li><a class="dropdown__link" href="/docs/3.0.41/installation-guide/Backups">3.0.41</a></li><li><a class="dropdown__link" href="/docs/3.0.40/installation-guide/Backups">3.0.40</a></li><li><a class="dropdown__link" href="/docs/3.0.39/installation-guide/Backups">3.0.39</a></li><li><a class="dropdown__link" href="/docs/3.0.38/installation-guide/Backups">3.0.38</a></li><li><a class="dropdown__link" href="/docs/3.0.37/installation-guide/Backups">3.0.37</a></li><li><a class="dropdown__link" href="/docs/3.0.36/installation-guide/Backups">3.0.36</a></li><li><a class="dropdown__link" href="/docs/3.0.35/installation-guide/Backups">3.0.35</a></li><li><a class="dropdown__link" href="/docs/3.0.34/installation-guide/Backups">3.0.34</a></li><li><a class="dropdown__link" href="/docs/3.0.33/index">3.0.33</a></li><li><a class="dropdown__link" href="/docs/3.0.32/index">3.0.32</a></li><li><a class="dropdown__link" href="/docs/3.0.31/index">3.0.31</a></li><li><a class="dropdown__link" href="/docs/3.0.30/index">3.0.30</a></li><li><a class="dropdown__link" href="/docs/3.0.29/index">3.0.29</a></li><li><a class="dropdown__link" href="/docs/3.0.28/index">3.0.28</a></li><li><a class="dropdown__link" href="/docs/3.0.27/index">3.0.27</a></li><li><a class="dropdown__link" href="/docs/3.0.26/index">3.0.26</a></li><li><a class="dropdown__link" href="/docs/3.0.25/index">3.0.25</a></li><li><a class="dropdown__link" href="/docs/3.0.24/index">3.0.24</a></li><li><a class="dropdown__link" href="/docs/3.0.23/index">3.0.23</a></li><li><a class="dropdown__link" href="/docs/3.0.22/index">3.0.22</a></li><li><a class="dropdown__link" href="/docs/3.0.21/index">3.0.21</a></li><li><a class="dropdown__link" href="/docs/3.0.20/index">3.0.20</a></li><li><a class="dropdown__link" href="/docs/3.0.19/index">3.0.19</a></li><li><a class="dropdown__link" href="/docs/3.0.18/index">3.0.18</a></li><li><a class="dropdown__link" href="/docs/3.0.17/index">3.0.17</a></li><li><a class="dropdown__link" href="/docs/3.0.16/index">3.0.16</a></li><li><a class="dropdown__link" href="/docs/3.0.9/index">3.0.9</a></li><li><a class="dropdown__link" href="/docs/3.0.8/index">3.0.8</a></li><li><a class="dropdown__link" href="/docs/3.0.7/index">3.0.7</a></li><li><a class="dropdown__link" href="/docs/3.0.6/index">3.0.6</a></li><li><a class="dropdown__link" href="/docs/3.0.5/index">3.0.5</a></li><li><a class="dropdown__link" href="/docs/3.0.4/index">3.0.4</a></li><li><a class="dropdown__link" href="/docs/3.0.3/index">3.0.3</a></li><li><a class="dropdown__link" href="/docs/3.0.2/index">3.0.2</a></li><li><a class="dropdown__link" href="/docs/3.0.1/index">3.0.1</a></li><li><a class="dropdown__link" href="/docs/3.0.0/index">3.0.0</a></li></ul></div><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Edge<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Gateway<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">UNS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Historian<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/esthesis-iot" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-3.0.43"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/3.0.43/index">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/3.0.43/installation-guide/">Installation guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Installation guide&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/3.0.43/installation-guide/Kubernetes">Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/3.0.43/installation-guide/AWS">Amazon Web Services (AWS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/3.0.43/installation-guide/Backups">Backups</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/3.0.43/startup-guide/">Startup guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Startup guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/3.0.43/user-guide/">User guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/3.0.43/device-agent/">Device Agent</a><button aria-label="Toggle the collapsible sidebar category &#x27;Device Agent&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/3.0.43/digital-twins/">Digital Twins</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/3.0.43/dataflows/">Dataflows</a><button aria-label="Toggle the collapsible sidebar category &#x27;Dataflows&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/3.0.43/developers-guide/">Developers Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developers Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/3.0.43/References/esthesis-line-protocol">References</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/3.0.43/contact-support/">Contact &amp; Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/3.0.43/uns-edge-gateway-historian">Edge, Gateway, UNS, Historian</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->esthesis CORE<!-- --> <b>3.0.43</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/installation-guide/Backups">latest version</a></b> (<!-- -->3.0.46<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/3.0.43/installation-guide/"><span itemprop="name">Installation guide</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Backups</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 3.0.43</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Backups</h1><p>The following sections provide instructions on how to configure backups for the esthesis CORE
services. The backup procedure is a combination of enabling the backup feature on the underlying
services, as well as configuring your deployment environment to store the backups. Accordingly,
instructions are targeting specific cloud environments.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="backup-with-a-custom-storage-class">Backup with a custom storage class<a href="#backup-with-a-custom-storage-class" class="hash-link" aria-label="Direct link to Backup with a custom storage class" title="Direct link to Backup with a custom storage class">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="backup-on-aws-with-efs">Backup on AWS with EFS<a href="#backup-on-aws-with-efs" class="hash-link" aria-label="Direct link to Backup on AWS with EFS" title="Direct link to Backup on AWS with EFS">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="backup-on-aws-with-s3">Backup on AWS with S3<a href="#backup-on-aws-with-s3" class="hash-link" aria-label="Direct link to Backup on AWS with S3" title="Direct link to Backup on AWS with S3">​</a></h2><p>The following section provides instructions on how to configure backups when running esthesis CORE
on AWS. Backups are targeting S3 buckets, which have been mounted as a Persistent Volume (PV) on
the Kubernetes cluster. To follow the next steps you need:</p><ul><li>An existing AWS Identity and Access Management (IAM) OpenID Connect (OIDC) provider for your
cluster. To determine whether you already have one, or to create one, see
<a href="https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html" target="_blank" rel="noopener noreferrer">Creating an IAM OIDC provider for your cluster</a>.</li><li>Version 2.12.3 or later of the AWS CLI installed and configured on your device or AWS CloudShell.</li><li>The <code>kubectl</code> command line tool is installed on your device or AWS CloudShell.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-iam-policy">Creating an IAM policy<a href="#creating-an-iam-policy" class="hash-link" aria-label="Direct link to Creating an IAM policy" title="Direct link to Creating an IAM policy">​</a></h3><p>The mount point for Amazon S3 CSI driver requires Amazon S3 permissions to interact with your file
system. This section shows how to create an IAM policy that grants the necessary permissions. The
following example policy follows the IAM permission recommendations for mount point. Alternatively,
you can use the AWS managed policy <code>AmazonS3FullAccess</code>, but this managed policy grants more
permissions than are needed. To create the IAM policy follow these steps:</p><ol><li>Open the IAM console at <a href="https://console.aws.amazon.com/iam/" target="_blank" rel="noopener noreferrer">https://console.aws.amazon.com/iam/</a>.</li><li>In the left navigation pane, choose Policies.</li><li>On the Policies page, choose Create policy.</li><li>For Policy editor, choose JSON.</li><li>Under Policy editor, copy and paste the following:</li></ol><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Replace <code>`DOC-EXAMPLE-BUCKET1`</code> with your own Amazon S3 bucket name.</p></div></div><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;Version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2012-10-17&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;Statement&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Sid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MountpointFullBucketAccess&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Effect&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Allow&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Action&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;s3:ListBucket&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Resource&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;arn:aws:s3:::DOC-EXAMPLE-BUCKET1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Sid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MountpointFullObjectAccess&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Effect&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Allow&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Action&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;s3:GetObject&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;s3:PutObject&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;s3:AbortMultipartUpload&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;s3:DeleteObject&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Resource&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;arn:aws:s3:::DOC-EXAMPLE-BUCKET1/*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li><p>Directory buckets, introduced with the S3 Express One Zone storage class, use a different authentication mechanism from general purpose buckets. Instead of using  <code>s3:*</code>  actions, you should use the  <code>s3express:CreateSession</code>  action. For information about directory buckets, see  <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/directory-buckets-overview.html" target="_blank" rel="noopener noreferrer">Directory buckets</a>  in the  <em>Amazon S3 User Guide</em>.</p><p>Below is an example of least-privilege policy that you would use for a directory bucket.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2012-10-17&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Statement&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Effect&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Allow&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Action&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s3express:CreateSession&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Resource&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;arn:aws:s3express:`aws-region`:`111122223333`:bucket/`` `DOC-EXAMPLE-BUCKET1`--az_id--x-s3``&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Choose  <strong>Next</strong>.</p></li><li><p>On the  <strong>Review and create</strong>  page, name your policy. This example walkthrough uses the name  <code>AmazonS3CSIDriverPolicy</code>.</p></li><li><p>Choose  <strong>Create policy</strong>.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-service-account-and-iam-role-with--eksctl">Create a service account and IAM role with  <code>eksctl</code><a href="#create-a-service-account-and-iam-role-with--eksctl" class="hash-link" aria-label="Direct link to create-a-service-account-and-iam-role-with--eksctl" title="Direct link to create-a-service-account-and-iam-role-with--eksctl">​</a></h3><p>To create the IAM role and the Kubernetes service account, run the following commands. These commands
also attach the  <code>AmazonS3CSIDriverPolicy</code> IAM policy to the role, annotate the Kubernetes service
account (<code>s3-csi-controller-sa</code>) with the IAM role&#x27;s Amazon Resource Name (ARN), and add the
Kubernetes service account name to the trust policy for the IAM role.</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">CLUSTER_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">my-cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">REGION</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">region-code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ROLE_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">AmazonEKS_S3_CSI_DriverRole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">POLICY_ARN</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">AmazonEKS_S3_CSI_DriverRole_ARN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eksctl create iamserviceaccount </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --name s3-csi-driver-sa </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --namespace kube-system </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cluster </span><span class="token variable" style="color:#36acaa">$CLUSTER_NAME</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --attach-policy-arn </span><span class="token variable" style="color:#36acaa">$POLICY_ARN</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --approve </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --role-name </span><span class="token variable" style="color:#36acaa">$ROLE_NAME</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --region </span><span class="token variable" style="color:#36acaa">$REGION</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --role-only</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-persistent-volume-for-backups-on-s3">Configure Persistent Volume for backups on S3<a href="#configure-persistent-volume-for-backups-on-s3" class="hash-link" aria-label="Direct link to Configure Persistent Volume for backups on S3" title="Direct link to Configure Persistent Volume for backups on S3">​</a></h3><p>To create a Persistent Volume that points to an S3 bucket you can use the following example:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PersistentVolume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;the</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">of</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">the</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">PV</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">capacity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">storage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 1200Gi </span><span class="token comment" style="color:#999988;font-style:italic"># ignored, required</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">accessModes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ReadWriteMany </span><span class="token comment" style="color:#999988;font-style:italic"># supported options: ReadWriteMany / ReadOnlyMany</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">mountOptions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> allow</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">delete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> region &lt;the</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">region</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">of</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">csi</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">driver</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> s3.csi.aws.com </span><span class="token comment" style="color:#999988;font-style:italic"># required</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumeHandle</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> s3</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">csi</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">driver</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumeAttributes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">bucketName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;the</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">of</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">the</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">bucket</span><span class="token punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You will have to replace the following:</p><ul><li><strong>the-name-of-the-PV</strong>: The name you want to give to you PV.</li><li><strong>the-aws-region-of-bucket</strong>: The region on which you bucket is. (eg. eu-central-1)</li><li><strong>the-name-of-the-bucket</strong>: The name of you bucket.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-helm-chart">Running the Helm chart<a href="#running-the-helm-chart" class="hash-link" aria-label="Direct link to Running the Helm chart" title="Direct link to Running the Helm chart">​</a></h2><p>You can configure the provided Helm chart to align with the resources you have created above using
the following environment parameters:</p><p>🔹 <code>INFLUXDB_ENABLED</code><br>
Whether InfluxDB should be installed by this chart or not.<br>
Default: <code>true</code></p><p>For MongoDB:</p><ul><li>ESTHESIS_BACKUP_MONGODB_CRONJOB_NAME: The name you want the cronjob to have. Default value is <code>esthesis-mongodb-backup-cronjob</code></li><li>ESTHESIS_BACKUP_MONGODB_USER: The root user for mongodb. Default value is <code>root</code></li><li>ESTHESIS_BACKUP_MONGODB_SECRET: The name of the secret that contains mongo-root-password. Default value is <code>my-mongodb</code></li><li>ESTHESIS_BACKUP_MONGODB_HOST: The name of the mongodb service on kubernetes. Default value is <code>my-mongodb</code></li><li>ESTHESIS_BACKUP_MONGODB_PORT: The port of mongodb. Default value is <code>27017</code></li><li>ESTHESIS_BACKUP_MONGODB_SCHEDULE: When you want the cronjob to run. Default value is <code>0 2 * * *</code></li><li>ESTHESIS_BACKUP_MONGODB_PATH: The path on the PV that the backups should be stored on. Default value is <code>backup/mongodb</code></li></ul><p>For InfluxDB:</p><ul><li>ESTHESIS_BACKUP_INFLUXDB_CRONJOB_NAME: The name you want the cronjob to have. Default value is <code>esthesis-influxdb-backup-cronjob</code></li><li>ESTHESIS_BACKUP_INFLUXDB_SECRET: The name of the secret that contains INFLUX_TOKEN. Default value is <code>my-influxdb</code></li><li>ESTHESIS_BACKUP_INFLUXDB_HOST: The name of the influxdb service on kubernetes. Default value is <code>my-influxdb</code></li><li>ESTHESIS_BACKUP_INFLUXDB_PORT: The port of influxdb. Default value is <code>8086</code></li><li>ESTHESIS_BACKUP_INFLUXDB_SCHEDULE: When you want the cronjob to run. Default value is <code>0 2 * * *</code></li><li>ESTHESIS_BACKUP_INFLUXDB_PATH: The path on the PV that the backups should be stored on. Default value is <code>backup/influxdb</code></li></ul><p>Backup PVC:</p><ul><li>ESTHESIS_BACKUP_PVC_NAME: The name you want the PVC to have. Default value is <code>esthesis-backup-s3-claim</code></li><li>ESTHESIS_BACKUP_VOLUME_NAME: The name of the PV that the PVC will be mounted on. Default value is <code>esthesis-backup-s3-pv</code></li><li>ESTHESIS_BACKUP_STORAGE_CLASS_NAME: If on S3, it should be left empty, otherwise it should be configured to the correct storageClassName. Default value is empty.</li><li>ESTHESIS_BACKUP_STORAGE: How much storage you want you PVC to request. Default value is <code>10Gi</code></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/3.0.43/installation-guide/AWS"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Amazon Web Services (AWS)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/3.0.43/startup-guide/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Startup guide</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#backup-with-a-custom-storage-class" class="table-of-contents__link toc-highlight">Backup with a custom storage class</a></li><li><a href="#backup-on-aws-with-efs" class="table-of-contents__link toc-highlight">Backup on AWS with EFS</a></li><li><a href="#backup-on-aws-with-s3" class="table-of-contents__link toc-highlight">Backup on AWS with S3</a><ul><li><a href="#creating-an-iam-policy" class="table-of-contents__link toc-highlight">Creating an IAM policy</a></li><li><a href="#create-a-service-account-and-iam-role-with--eksctl" class="table-of-contents__link toc-highlight">Create a service account and IAM role with  <code>eksctl</code></a></li><li><a href="#configure-persistent-volume-for-backups-on-s3" class="table-of-contents__link toc-highlight">Configure Persistent Volume for backups on S3</a></li></ul></li><li><a href="#running-the-helm-chart" class="table-of-contents__link toc-highlight">Running the Helm chart</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Products</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis CORE</a></li><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis EDGE</a></li><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis GATEWAY</a></li><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis UNS</a></li><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis HISTORIAN</a></li></ul></div><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis CORE</a></li><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis EDGE</a></li><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis GATEWAY</a></li><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis UNS</a></li><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis HISTORIAN</a></li></ul></div><div class="col footer__col"><div class="footer__title">Tutorials</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://esthes.is" target="_blank" rel="noopener noreferrer" class="footer__link-item">esthesis YouTube</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://youtube.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.eurodyn.com/contact" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact page</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div><a href="https://www.eurodyn.com" target="_blank">European Dynamics</a> &copy; 2024</div></div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.a6375d9b.js"></script>
<script src="/docs/assets/js/main.6fd6813d.js"></script>
</body>
</html>