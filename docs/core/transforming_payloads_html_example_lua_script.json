{"objectID":"_transforming_payloads.html#example_lua_script","parent":"_transforming_payloads.html#lua_incoming_payload_variable","pageViews":0,"url":"writerside-documentation/transforming-payloads.html#example-lua-script","mainTitle":"Transforming payloads","product":"","headings":"Transforming payloads,Example Lua script","content":"Let us consider an external data source that pushes data in the following format:\ncpu\ntemperature\u003d20\nload\u003d2\nThe first line is always the category name, whereas the remaining lines contain individual measurements for that category. Measurements are separated by an equal sign.\nWe want to transform this incoming payload to eLP format, such as:\ncpu temperature\u003d20,load\u003d2\nThe following Lua script could be used to achieve this:\n-- Splitting the payload into lines\nlocal lines \u003d {}\nfor line in payload:gmatch(\"[^\\r\\n]+\") do\n    table.insert(lines, line)\nend\n\n-- Extracting the category and measurements\nlocal category \u003d lines[1]\nlocal measurements \u003d {}\nfor i \u003d 2, #lines do\n    local measurement \u003d lines[i]:gsub(\"%s+\", \"\")  -- Remove whitespace\n    table.insert(measurements, measurement)\nend\n\n-- Constructing the single-line format\nlocal transformedPayload \u003d category .. \" \" .. table.concat(measurements, \",\")\n\nreturn transformedPayload\n","pageTitle":"Example Lua script","metaDescription":"","type":"Documentation","breadcrumbs":"Device Agent","root":0,"depth":1}