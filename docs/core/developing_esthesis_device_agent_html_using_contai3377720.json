{"objectID":"_developing_esthesis_device_agent.html#using_containers","parent":"_developing_esthesis_device_agent.html#run_and_compile","pageViews":0,"url":"writerside-documentation/developing-esthesis-device-agent.html#using-containers","mainTitle":"Developing esthesis Device Agent","product":"","headings":"Developing esthesis Device Agent,Using containers","content":"To execute one (or more) device agents in Docker containers running on your local machine, connecting to your development esthesis CORE instance, you need to prepare the following:\n2. A container running kubefwd to forward the Mosquitto service:\ndocker run -d --privileged \\\n\t--add-host\u003dhost.docker.internal:host-gateway \\\n\t--name kubefwd \\\n\t-v \"$(echo $HOME)/.kube/config\":/root/.kube/config \\\n\ttxn2/kubefwd services -d esthesis -n esthesis -f metadata.name\u003dmosquitto\n4. A container running the device agent, obtaining its network via the container you created above:\nREGISTRY_URL\u003d\u0026lt;your-registry\u0026gt; \u0026\u0026 \\\nRND_PREFIX\u003desthesis-test-device-$(uuidgen | cut -f1 -d\"-\" | awk \u0027{print tolower($0)}\u0027) \u0026\u0026 \\\nfor ((i\u003d1; i\u0026lt;\u003d3; i++)); do\n\tHID\u003d$RND_PREFIX-$i \u0026\u0026 \\\n\tdocker run -d --name $HID \\\n\t\t-e HARDWARE_ID\u003d$HID \\\n\t\t-e REGISTRATION_URL\u003dhttp://host.docker.internal:59070/api/v1/register \\\n\t\t-e PROPERTIES_FILE\u003d/app/.esthesis/esthesis.properties \\\n\t\t-e SECURE_PROPERTIES_FILE\u003d/app/.esthesis/secure/esthesis.properties \\\n\t\t-e TEMP_DIR\u003d/app/.esthesis/temp \\\n\t\t-e VERSION_FILE\u003d/app/version \\\n\t\t-e PROVISIONING_SCRIPT\u003d/app/firmware-update.sh \\\n\t\t-e LOG_LEVEL\u003ddebug \\\n\t\t-e AUTO_UPDATE\u003dfalse \\\n\t\t-e SECURE_PROVISIONING\u003dtrue \\\n\t\t-e TAGS\u003ddev \\\n\t\t--net container:kubefwd \\\n\t\t$REGISTRY_URL/esthesisiot/esthesis-core-device:latest\ndone\n","pageTitle":"Using containers","metaDescription":"","type":"Documentation","breadcrumbs":"Developers Guide","root":0,"depth":1}