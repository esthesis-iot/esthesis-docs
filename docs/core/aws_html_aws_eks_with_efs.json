{"objectID":"_aws.html#aws_eks_with_efs","parent":"_aws.html#aws_eks_with_efs","pageViews":0,"url":"writerside-documentation/aws.html#aws-eks-with-efs","mainTitle":"Amazon Web Services (AWS)","product":"","headings":"Amazon Web Services (AWS),AWS EKS with EFS","content":"If you are using AWS EKS with EFS, you will need to create a storage class that uses EFS. You can create a default storage class that uses EFS by deploying the following descriptor:\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: efs-sc\nprovisioner: efs.csi.aws.com\nparameters:\n  provisioningMode: efs-ap\n  fileSystemId: \u0026lt;file-system-id from EFS\u0026gt;\n  directoryPerms: \"700\"\n  reuseAccessPoint: \"false\" # optional\n  ensureUniqueDirectory: \"true\" # optional\n  basePath: /efs-dp # optional\n  subPathPattern: ${.PVC.name} # optional\nHowever, there are certain charts (specifically, the ones from Bitnami) that require a specific uid and gid to be set in the storage class\u0027 underlying user. For that, you need to create an additional storage class that uses EFS and sets the uid and gid to 1001 (for Bitnami charts). You can create such a storage class by deploying the following descriptor:\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: bitnami-sc\nprovisioner: efs.csi.aws.com\nparameters:\n  provisioningMode: efs-ap\n  fileSystemId: \u0026lt;file-system-id from EFS\u0026gt;\n  directoryPerms: \"700\"\n  reuseAccessPoint: \"false\" # optional\n  ensureUniqueDirectory: \"true\" # optional\n  basePath: /efs-dp # optional\n  subPathPattern: ${.PVC.name} # optional\n  gid: \"1001\"\n  uid: \"1001\"\nWhen deploying esthesis CORE dependencies, you will need to specify the Bitnami-specific storage class for MongoDB, and Keycloak by setting the following environment variables prior to running the Helmfile install command:\nMONGODB_STORAGE_CLASS\u003dbitnami-sc\nKEYCLOAK_STORAGE_CLASS\u003dbitnami-sc\n","pageTitle":"AWS EKS with EFS","metaDescription":"","type":"Documentation","breadcrumbs":"Installation guide","root":0,"depth":1}