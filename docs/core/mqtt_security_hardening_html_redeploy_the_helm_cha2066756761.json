{"objectID":"_mqtt_security_hardening.html#redeploy_the_helm_chart_enabling_tls","parent":"_mqtt_security_hardening.html#create_a_certificate_authority_and_a_certificate","pageViews":0,"url":"writerside-documentation/mqtt-security-hardening.html#redeploy-the-helm-chart-enabling-tls","mainTitle":"MQTT security hardening","product":"","headings":"MQTT security hardening,Redeploy the Helm chart enabling TLS","content":"Go to the location where you deployed the esthesis dependencies via executing helmfile sync and add the following environment variables:\nexport MOSQUITTO_MUTUAL_TLS\u003dtrue\nexport MOSQUITTO_CA_CERT\u003d$(cat ca.crt | base64)\nexport MOSQUITTO_SERVER_CERT\u003d$(cat server.crt | base64)\nexport MOSQUITTO_SERVER_KEY\u003d$(cat server.key | base64)\n2. Replace the names of ca.crt, server.crt and server.key with the files you downloaded above.\n4. During the deployment of the supporting infrastructure you, probably, had to define an array of environment variables to be used by the Helm charts. Do not forget to re-specify these variables before you re-run the helmfile sync command here, otherwise the deployment might fail or have unexpected results.\n6. The name of the user specified by MOSQUITTO_SUPER_USER (in your environment variables while deploying the supporting infrastructure) will be the \u0026quot;superuser\u0026quot; for the MQTT, i.e. a user that can subscribe and publish to/from any topic. Create a separate certificate for this user, having the Common Name set to the same name as the one you specified by MOSQUITTO_SUPER_USER (if you did not specify a value for MOSQUITTO_SUPER_USER, the default value is \u0027esthesis\u0027).\n","pageTitle":"Redeploy the Helm chart enabling TLS","metaDescription":"","type":"Documentation","breadcrumbs":"Startup guide","root":0,"depth":1}